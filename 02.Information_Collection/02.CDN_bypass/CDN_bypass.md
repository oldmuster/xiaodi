## 信息收集-CDN绕过

```
简介：
	CDN的全称是Content Delivery Network，即内容分发网络。CDN是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络阻塞，提高用户访问响应速度和命中率。但在安全测试过程中，若目标存在CDN服务，将会影响到后续的安全测试过程。
	
如果目标有CDN服务，你直接对这个目标进行渗透的时候，渗透的是这个目标的缓存，不是真正意义上的目标
```



### 本节内容

- 如何判断目标存在CDN服务

  利用多节点技术进行请求返回判断

  ```
  在http://ping.chinaz.com/中输入网址进行ping检测，如果响应IP都相同则不存在CDN服务，存在不相同的则存在CDN服务。 
  ```

- CDN对于安全测试有哪些影响

- 目前常见的CDN绕过技术有哪些

  子域名查询

  ```
  例如news.xiaodi8.com是xiaodi8.com的子域名
  
  如果子域名和目标域名在同一服务器或者同一网段下对于CDN绕过的意义：
  	主站的流量一般比分站要多，有的管理员为了节省成本，只对主站做CDN服务，并不会对分站或子域名的站点做CDN服务，如果说子域名没有做CDN服务，则他的真实IP可以推算出主站IP
  ```

  邮件服务查询

  ```
  邮箱服务器一般不会做CDN
  ```

  国外地址请求

  ```
  有些网址是面向国内服务的，只设置了国内人CDN，并没有不知国外的CDN，所以可以直接用国外地址来进行请求，这样有可能请求到的就是目标服务器的IP地址
  ```

  遗留文件，扫描全网

  黑暗引擎搜索特定文件

  ```
  https://www.shodan.io/
  https://www.zoomeye.org/
  https://fofa.so/
  ```

  dns历史记录，以量打量

  ```
  找它以前没有使用CDN时指向的地址
  
  以量打量：Dos攻击，耗尽网站的CDN服务的流量，不推荐使用，违法
  ```

  

- CDN真实IP地址获取后绑定指向地址

  更改本地HOSTS解析指向文件



### 本节演示案例

- 利用子域名请求获取真实IP

- 利用国外地址请求获取真实IP

- 利用第三方接口查询获取真实IP

- 利用邮件服务器接口获取真实IP

- 利用黑暗引擎搜索特定文件获取真实IP



- xueersi 	子域名上面的小技巧

  ![域名CDN设置](imgs\域名CDN设置.png)

- sp910 		DNS记录=第三方接口（接口查询）
    	https://get-site-ip.com/
    	https://x.threatbook.cn/（需要花钱，查询历史IP）
    	

- m.sp910（手机端网址）		子域名小技巧/采集/国外请求（同类型访问）

- mozhe		邮件源码测试对比第三方查询（地区分析）

- v23gg		黑暗引擎（shodan搜索指定hash文件）





  